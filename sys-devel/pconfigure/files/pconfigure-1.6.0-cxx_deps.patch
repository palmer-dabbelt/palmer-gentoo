commit f6aed4af4b3798a590fad969cf4a7ff6edde2fc1
Author: Palmer Dabbelt <palmer@dabbelt.com>
Date:   Thu Sep 6 11:18:28 2012 -0700

    Fix a C++ dependency bug
    
    The problem is that some C++ packages name their include files without
    any extension, and this was accidentally hitting some fall-through
    case such that the C++ dependency generator was treating this header
    file like a C file.  The fix is just to explicitly check rather than
    implicitly falling through.

diff --git a/src/pconfigure/lang/cxx.c b/src/pconfigure/lang/cxx.c
index 7748c1a..779e882 100644
--- a/src/pconfigure/lang/cxx.c
+++ b/src/pconfigure/lang/cxx.c
@@ -93,7 +93,7 @@ void language_cxx_extras(struct language *l_uncast, struct context *c,
 
 			     cfile = talloc_vasprintf(context, format, args);
 			     cxxfile = talloc_array(context, char,
-						    strlen(cfile) + 10);
+						    strlen(cfile) + 20);
 
 			     memset(cxxfile, 0, strlen(cfile) + 10);
 			     strncpy(cxxfile, cfile, strlen(cfile) - 2);
@@ -122,7 +122,8 @@ void language_cxx_extras(struct language *l_uncast, struct context *c,
 			     if (strcmp(cfile + strlen(cfile) - 4, ".hpp") == 0)
 				 cfile[strlen(cfile)-3] = 'c';
 			     if (access(cfile, R_OK) == 0)
-				 func(cfile);
+				 if (strcmp(cfile + strlen(cfile) - 2, ".c") == 0)
+				     func(cfile);
 			     
 			     va_end(args);
 			 }
